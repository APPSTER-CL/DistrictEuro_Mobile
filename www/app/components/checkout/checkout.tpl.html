<ion-view class="checkout-view" cache-view="false">
  <ion-header-bar class="checkout-header">
    <div class="buttons">
      <button class="button button-clear cancel-button" ng-click="cancel()">{{ 'CHECKOUT_CANCEL' | translate }}</button>
    </div>
    <h1 class="title">{{ 'CARTS_CHECKOUT' | translate }}</h1>
  </ion-header-bar>
  <form name="checkoutForm">
    <ion-content has-bouncing="false" class="checkout-content">
      <div class="row order-brief-row">
        <div class="col col-67">
          <div class="row illustration-row">
            <div class="col">
              <span class="order-brief-callout">{{products.length}}
                {{ products.length === 1 ? 'item' : 'items' }}
                {{ 'CHECKOUT_READY' | translate }}</span>
            </div>
          </div>
        </div>
        <div class="col col-33 col-center order-total-col">
          <div class="order-total-wrapper">
            <span class="brief-total-title">{{ 'CHECKOUT_TOTAL' | translate }}:</span>
            <span class="brief-total">{{ products[0].price_currency }}
              {{ getTotal() | number:2 }}</span>
          </div>
        </div>
      </div>
      <h3 class="checkout-sub-title">{{ 'CHECKOUT_ADDRESS_INFO' | translate }}</h3>
      <div class="row address-row">
        <div class="col">
          <div class="address-chooser">
            <a class="button button-block icon-right ion-chevron-right choose-addresses-button"
              ng-class="{'aa': addresses_popover.isShown(), 'bb' : !addresses_popover.isShown()}"
              ui-sref="main.app.checkout.address()">{{ getSelectedAddress() || ('SHIPPING_ADDRESS' | translate ) }}
            </a>
          </div>
        </div>
      </div>
      <h3 class="checkout-sub-title">{{ 'CHECKOUT_PAYMENT_INFO' | translate }}</h3>
      <div class="row promo-code-row">
        <div class="col">
          <label class="item item-input promo-item">
            <span class="input-label">{{ 'CHECKOUT_PROMO_CODE' | translate }}</span>
            <input type="text">
          </label>
        </div>
      </div>
      <div class="row card-row">
        <div class="col">
          <div class="address-chooser">
            <a class="button button-block icon-right ion-chevron-right choose-card-button"
              ng-class="{'aa': addresses_popover.isShown(), 'bb' : !addresses_popover.isShown()}"
              ui-sref="main.app.checkout.card()">
                <img ng-src="./img/icons/card-union-pay.png">
                <span>{{ getSelectedCard() || ('CREDIT_CARD' | translate) }}</span>
            </a>
          </div>
        </div>
      </div>
      <div class="row card-row">
        <div class="col center">
          <input type=radio name="creditCardRadio">
          <img ng-src="./img/icons/card-tenpay.png">
        </div>
        <div class="col center">
          <input type=radio name="creditCardRadio">
          <img ng-src="./img/icons/card-alipay.png">
        </div>
      </div>
      <h3 class="checkout-sub-title">{{ 'CHECKOUT_ORDER' | translate }}</h3>
      <ul class="list checkout-products">
        <li class="item checkout-product" ng-repeat="product in products">
          <div class="row">
            <div class="col col-20 product-image-col">
              <div class="product-image-container" multi-bg="[product.image.small_url]"></div>
            </div>
            <div class="col col-50 col-center">
              <span class="product-name">{{product.name}}</span>
            </div>
            <div class="col col-center">
              <span class="product-price">{{ products[0].price_currency }}
                {{product.price_amount}}</span>
            </div>
          </div>
        </li>
      </ul>
      <ul class="list checkout-bill">
        <li class="item">
          <div class="row">
            <div class="col">
              <span class="bill-item-title">{{ 'CARTS_PRICE_SUB' | translate }}</span>
            </div>
            <div class="col">
              <span class="bill-item-value">{{ products[0].price_currency }}
                {{ getSubtotal() | number:2 }}</span>
            </div>
          </div>
        </li>
        <li class="item">
          <div class="row">
            <div class="col">
              <span class="bill-item-title">{{ 'CARTS_ESTIMATED_TAXES' | translate }}</span>
            </div>
            <div class="col">
              <span class="bill-item-value">{{ products[0].price_currency }}
                {{ getTax() | number:2 }}</span>
            </div>
          </div>
        </li>
        <li class="item">
          <div class="row">
            <div class="col">
              <span class="bill-item-title">{{ 'CARTS_SHIPPING' | translate }}</span>
            </div>
            <div class="col">
              <span class="bill-item-value">{{ 'FREE' | translate }}</span>
            </div>
          </div>
        </li>
        <li class="item bill-total">
          <div class="row">
            <div class="col">
              <span class="bill-item-title">{{ 'CARTS_PRICE_TOTAL' | translate }}</span>
            </div>
            <div class="col">
              <span class="bill-item-value" style="color: #c2d61e;">{{ products[0].price_currency }}
                {{ getTotal() | number:2 }}</span>
            </div>
          </div>
        </li>
      </ul>
    </ion-content>
    <ion-footer-bar class="checkout-footer">
      <a class="button button-full checkout-button" ng-click="buy()" ng-disabled="!placeOrderIsValid()" ui-sref="main.app.checkout.thanks()">
        <span>{{ 'CHECKOUT_PLACE_ORDER' | translate }}</span>
      </a>
    </ion-footer-bar>
  </form>
</ion-view>
